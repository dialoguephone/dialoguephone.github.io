<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>√âditeur d'Arbre de Dialogue</title>
</head>
<body>
    <div class="container">
        <div class="phone-container">
            <div class="phone-screen">
                <div class="header" id="headerTitle">
                    √âditeur de Dialogue - Racine
                </div>
                
                <div class="messages-container" id="messagesContainer">
                    <div class="status" id="statusMessage">
                        Commencez par cr√©er votre premier message ou importez un dialogue existant...
                    </div>
                </div>
                
                <div class="controls">
                    <div class="navigation">
                        <button class="btn secondary" onclick="goBack()" id="backBtn" disabled>‚Üê Retour</button>
                        <div class="breadcrumb" id="breadcrumb">Racine</div>
                    </div>
                    
                    <div class="datetime-controls">
                        <button class="btn small secondary" onclick="setCurrentDateTime()">Maintenant</button>
                        <button class="btn small secondary" onclick="clearDateTime()">Effacer</button>
                        <span style="font-size: 12px; color: #666;">Date/Heure du message</span>
                    </div>
                    
                    <div class="input-group">
                        <select class="character-select" id="characterSelect">
                            <option value="A">Personnage A</option>
                            <option value="B">Personnage B</option>
                        </select>
                        <input type="text" class="message-input" id="messageInput" placeholder="Tapez votre message...">
                        <input type="datetime-local" class="datetime-input" id="datetimeInput" title="Date et heure du message">
                        <button class="btn" onclick="addMessage()">Envoyer</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                        <button class="btn secondary" onclick="addChoicePoint()">+ Choix Multiple</button>
                        <button class="btn fake-choice-btn" onclick="addFakeChoice()">üëª Fake Choice</button>
                        <button class="btn success" onclick="finishBranch()">Finir Branche</button>
                        <button class="btn warning" onclick="showImportDialog()">üì• Importer</button>
                        <button class="btn danger" onclick="clearAll()">Tout Effacer</button>
                    </div>
                    
                    <!-- Contr√¥les pour choix normaux -->
                    <div class="choice-controls" id="choiceControls">
                        <h4>Cr√©er un point de choix :</h4>
                        <div id="choicesList">
                            <!-- Les choix seront ajout√©s dynamiquement ici -->
                        </div>
                        <button class="btn small secondary add-choice-btn" onclick="addNewChoice()">+ Ajouter un choix</button>
                        <div class="choice-actions">
                            <button class="btn" onclick="saveChoicePoint()">Sauvegarder Choix</button>
                            <button class="btn secondary" onclick="cancelChoice()">Annuler</button>
                        </div>
                    </div>

                    <!-- Contr√¥les pour fake choices -->
                    <div class="fake-choice-controls" id="fakeChoiceControls">
                        <h4>üé≠ Cr√©er un Fake Choice :</h4>
                        <p class="fake-choice-info">Un fake choice revient √† l'histoire principale apr√®s quelques messages</p>
                        <div id="fakeChoicesList">
                            <!-- Les fake choices seront ajout√©s dynamiquement ici -->
                        </div>
                        <button class="btn small fake-choice-btn add-choice-btn" onclick="addNewFakeChoice()">+ Ajouter un fake choice</button>
                        <div class="choice-actions">
                            <button class="btn fake-choice-btn" onclick="saveFakeChoicePoint()">Sauvegarder Fake Choices</button>
                            <button class="btn secondary" onclick="cancelFakeChoice()">Annuler</button>
                        </div>
                    </div>

                    <!-- Contr√¥les pour finir un fake choice -->
                    <div class="finish-fake-choice-controls" id="finishFakeChoiceControls">
                        <h4>üîö Finir le Fake Choice</h4>
                        <p>Choisissez le message o√π reconnecter :</p>
                        <select class="reconnect-select" id="reconnectSelect">
                            <!-- Options remplies dynamiquement -->
                        </select>
                        <div class="choice-actions">
                            <button class="btn fake-choice-btn" onclick="saveReconnection()">Reconnecter</button>
                            <button class="btn secondary" onclick="cancelReconnection()">Annuler</button>
                        </div>
                    </div>

                    <!-- Contr√¥les pour √©diter un message -->
                    <div class="edit-message-controls" id="editMessageControls">
                        <h4>‚úèÔ∏è √âditer le message</h4>
                        <div class="input-group">
                            <select class="character-select" id="editCharacterSelect">
                                <option value="A">Personnage A</option>
                                <option value="B">Personnage B</option>
                            </select>
                            <textarea class="message-input" id="editMessageInput" placeholder="Texte du message..." rows="3"></textarea>
                            <input type="datetime-local" class="datetime-input" id="editDatetimeInput" title="Date et heure du message">
                        </div>
                        <div class="choice-actions">
                            <button class="btn" onclick="saveEditedMessage()">Sauvegarder</button>
                            <button class="btn danger" onclick="deleteMessage()">Supprimer</button>
                            <button class="btn secondary" onclick="cancelEditMessage()">Annuler</button>
                        </div>
                    </div>

                    <!-- Contr√¥les pour √©diter un choix -->
                    <div class="edit-choice-controls" id="editChoiceControls">
                        <h4>‚úèÔ∏è √âditer le choix</h4>
                        <input type="text" class="message-input" id="editChoiceInput" placeholder="Texte du choix...">
                        <div class="choice-actions">
                            <button class="btn" onclick="saveEditedChoice()">Sauvegarder</button>
                            <button class="btn secondary" onclick="cancelEditChoice()">Annuler</button>
                        </div>
                    </div>

                    <div class="import-controls" id="importControls">
                        <h4>Importer un dialogue JSON :</h4>
                        <div id="importAlert"></div>
                        <textarea class="import-textarea" id="importTextarea" placeholder="Collez votre JSON de dialogue ici..."></textarea>
                        <div class="import-actions">
                            <button class="btn success" onclick="importJSON()">üì• Importer</button>
                            <button class="btn secondary" onclick="cancelImport()">Annuler</button>
                        </div>
                    </div>
                    
                    <div class="controls-scroll-indicator">‚Üï D√©filez pour plus d'options</div>
                </div>
            </div>
        </div>
        
        <div class="sidebar">
            <div class="export-import-section">
                <h3>Import/Export JSON</h3>
                <div class="export-import-buttons">
                    <button class="btn" onclick="exportJSON()">üì§ Exporter JSON</button>
                    <button class="btn secondary" onclick="copyToClipboard()">üìã Copier</button>
                </div>
                <div id="exportAlert"></div>
                <textarea class="json-output" id="jsonOutput" readonly placeholder="Le JSON de l'arbre complet appara√Ætra ici..."></textarea>
            </div>

            <h3>Arbre de Dialogue</h3>
            <div class="path-info" id="pathInfo">
                Profondeur actuelle: 0 | Messages dans cette branche: 0
            </div>
            <div id="treeView" class="tree-view">
                <div class="tree-node current-path">
                    <div class="tree-message">Racine du dialogue</div>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
